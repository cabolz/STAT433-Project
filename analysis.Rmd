---
title: "analysis"
output: html_document
---

```{r}
library(readr)
library(leaps)
library(DAAG)
```

```{r}
fullData = read_csv("fulldata.csv")
```

```{r}
fullData<- na.omit(fullData)
fullData
fullSet = fullData %>% 
  group_by(hour,day) %>% 
  summarize(pickups = n())
View(fullSet)
```

```{r}
a<-c(1,2,3,4,5)
a<-as.double(a)
a
Y<-fullData %>% 
  group_by(hour) %>% 
  summarize(pickup = n(),Humidity,temperature,pressure,windspeed) %>%
  mutate(hours = as.double(hour)) %>% 
  ungroup %>% 
  transmute(pickup, hours,windspeed,pressure,temperature,Humidity)
Y
lin<-lm(pickup~.,data = Y)
summary(lin)
```


```{r}
myLeaps<- regsubsets(pickup~Humidity+temperature+pressure+windspeed,data = Y,nbest = 4)
  (myLeaps.summary<- summary(myLeaps))

bettertable<- cbind(myLeaps.summary$which,
                    myLeaps.summary$rsq, myLeaps.summary$rss,
                    myLeaps.summary$adjr2,myLeaps.summary$cp, myLeaps.summary$bic)
dimnames(bettertable)[[2]]<- c(dimnames(myLeaps.summary$which)[[2]],
                               "R2","SSE","R2_(adj)","cp","BIC")
bettertable=round(bettertable,3)
bettertable
n=dim(Y)[1]
fit0<- lm(pickup~1, data=Y)
fitall<- lm(pickup~Humidity+temperature+pressure+windspeed, data=Y)
```


```{r}
m1<-step(fit0,fitall,direction = "forward", k=log(n))
summary(m1)
m2<-step(fitall,direction="backward",k=log(n))
summary(m2)
m3<-step(fitall,direction="both",k=log(n))
summary(m3)
```


```{r}
m1<- "pickup~Humidity+temperature+pressure"
m2<- "pickup~1"
model1cv=CVlm(data = Y, form.lm = formula(m1), m=8, seed=7,plotit=F)
model2cv=CVlm(data = Y, form.lm = formula(m2),m=8,seed=7,plotit = F)
```

# PCA first check for multicollinearity
```{r}
pairs(Y)
plot(Y$hour,Y$temperature)
plot()
pairs(iris[1:4], main = "Anderson's Iris Data -- 3 species",
      pch = 21, bg = c("red", "green3", "blue")[unclass(iris$Species)])
cor(Y)
```


```{r}
fullData<- fullData %>% 
  mutate(boroughCode = as.double(boroughCode)) %>% 
  mutate(hour = as.double(hour)) %>% 
  mutate(minute = as.double(minute)) %>% 
  mutate(month = as.double(month)) %>% 
  mutate(day = as.double(day)) %>% 
  group_by(hour) %>% 
  mutate(pickup = n()) %>% 
  mutate(pickup = as.double(pickup))
fullData
byNeighborhood<- fullData %>% 
  group_by(neighborhood)
byNeighborhood
```
